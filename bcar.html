<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=0.5,maximum-scale=1.0" >
<title>购物车</title>
</head>
<link href="css/base.css" rel="stylesheet">
<link href="css/bcar.css" rel="stylesheet">
</head>
<script>
	(function(win,doc){
		function change(){
			doc.documentElement.style.fontSize=doc.documentElement.clientWidth/375*20+'px';
		}		
		change();
		win.addEventListener('resize',change,false);
	})(window,document);
</script>
<style>

</style>

<body>
    <div class="wrap">
        <div class="bundlev">
            <div class="shop">
                <div class="title-shop">
                    <div class="tcont clearfix">
                        <div class="shopcb fl">
                            <p>
                                <input type="checkbox"  id="120" style="display:none" class="t-cb" name="newslist">
                                <label for="120"></label>
                            </p>
                        </div>
                        <div class="t-c clearfix fl">
                            <div class="contcat fl">
                                <a href="javascript:;">
                                    上海艺星整容医疗医院
                                </a>
                            </div>
                            <div class="state fr">
                                <a href="javascript:;">
                                    <span class="ico"></span>
                                    <p>编辑</p>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="group clearfix">
                <div class="item-cb fl">
                    <p>
                        <input type="checkbox"  id="121" style="display:none" name="newslist">
                        <label for="121"></label>
                    </p>
                </div>
                <div class="item-detail fl ">
                    <div class="clearfix">
                        <div class="item-img fl">
                            <a href="javascript:;">
                                <img src="image/bcar/qg-1.jpg" alt="">
                            </a>
                        </div>
                        <div class="item-info fl">
                            <a href="javascript:;">
                                <h3 class="sku">[重睑术](切开或埋线)专为女性设计，为你打造灵动双眸拥有迷人气质</h3>
                                <div class="money1">项目金额：<i>350</i></div>
                            </a>
                        </div>
                        <div class="delete fl">
                            <div class="del fl">
                                <div class="quantity clearfix">
                                    <p class="btn-minus">
                                        <a href="javascript:;">
                                            <img src="image/bcar/jian.png" alt="">
                                        </a>
                                    </p>
                                    <p class="btn-input">
                                        <input type="number" min="1" value="1">
                                    </p>
                                    <p class="btn-plus">
                                         <a href="javascript:;">
                                            <img src="image/bcar/jia.png" alt="">
                                        </a>
                                    </p>
                                </div>
                                <div class="price fl">预约金额：<i>350</i></div>
                            </div>
                            <div class="item-del fr">
                                <p>删除</p>
                            </div>
                        </div>
                    </div>
                    <div class="pay clearfix">
                        <div class="price fl">
                            预约金额：<i>350</i>
                        </div>
                        <div class="quantity clearfix fr">
                            <p class="btn-minus">
                                <a href="javascript:;">
                                    <img src="image/bcar/jian.png" alt="">
                                </a>
                            </p>
                            <p class="btn-input">
                                <input type="number" min="1" value="1">
                            </p>
                            <p class="btn-plus">
                                 <a href="javascript:;">
                                    <img src="image/bcar/jia.png" alt="">
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="bundlev">
            <div class="shop">
                <div class="title-shop">
                    <div class="tcont clearfix">
                        <div class="shopcb fl">
                            <p>
                                <input type="checkbox"  id="130" style="display:none" class="t-cb" name="newslist">
                                <label for="130"></label>
                            </p>
                        </div>
                        <div class="t-c clearfix fl">
                            <div class="contcat fl">
                                <a href="javascript:;">
                                    上海艺星整容医疗医院
                                </a>
                            </div>
                            <div class="state fr">
                                <a href="javascript:;">
                                    <span class="ico"></span>
                                    <p>编辑</p>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="group clearfix">
                <div class="item-cb fl">
                    <p>
                        <input type="checkbox"  id="131" style="display:none" name="newslist">
                        <label for="131"></label>
                    </p>
                </div>
                <div class="item-detail fl ">
                    <div class="clearfix">
                        <div class="item-img fl">
                            <a href="javascript:;">
                                <img src="image/bcar/qg-1.jpg" alt="">
                            </a>
                        </div>
                        <div class="item-info fl">
                            <a href="javascript:;">
                                <h3 class="sku">[重睑术](切开或埋线)专为女性设计，为你打造灵动双眸拥有迷人气质</h3>
                                <div class="money1">项目金额：<i>500</i></div>
                            </a>
                        </div>
                        <div class="delete fl">
                            <div class="del fl">
                                <div class="quantity clearfix">
                                    <p class="btn-minus">
                                        <a href="javascript:;">
                                            <img src="image/bcar/jian.png" alt="">
                                        </a>
                                    </p>
                                    <p class="btn-input">
                                        <input type="number" min="1" value="1">
                                    </p>
                                    <p class="btn-plus">
                                         <a href="javascript:;">
                                            <img src="image/bcar/jia.png" alt="">
                                        </a>
                                    </p>
                                </div>
                                <div class="price fl">预约金额：<i>500</i></div>
                            </div>
                            <div class="item-del fr">
                                <p>删除</p>
                            </div>
                        </div>
                    </div>
                    <div class="pay clearfix">
                        <div class="price fl">
                            预约金额：<i>500</i>
                        </div>
                        <div class="quantity clearfix fr">
                            <p class="btn-minus">
                                <a href="javascript:;">
                                    <img src="image/bcar/jian.png" alt="">
                                </a>
                            </p>
                            <p class="btn-input">
                                <input type="number" min="1" value="1">
                            </p>
                            <p class="btn-plus">
                                 <a href="javascript:;">
                                    <img src="image/bcar/jia.png" alt="">
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="group clearfix">
                <div class="item-cb fl">
                    <p>
                        <input type="checkbox"  id="132" style="display:none" name="newslist">
                        <label for="132"></label>
                    </p>
                </div>
                <div class="item-detail fl ">
                    <div class="clearfix">
                        <div class="item-img fl">
                            <a href="javascript:;">
                                <img src="image/bcar/qg-1.jpg" alt="">
                            </a>
                        </div>
                        <div class="item-info fl">
                            <a href="javascript:;">
                                <h3 class="sku">[重睑术](切开或埋线)专为女性设计，为你打造灵动双眸拥有迷人气质</h3>
                                <div class="money1">项目金额：<i>500</i></div>
                            </a>
                        </div>
                        <div class="delete fl">
                            <div class="del fl">
                                <div class="quantity clearfix">
                                    <p class="btn-minus">
                                        <a href="javascript:;">
                                            <img src="image/bcar/jian.png" alt="">
                                        </a>
                                    </p>
                                    <p class="btn-input">
                                        <input type="number" min="1" value="1">
                                    </p>
                                    <p class="btn-plus">
                                         <a href="javascript:;">
                                            <img src="image/bcar/jia.png" alt="">
                                        </a>
                                    </p>
                                </div>
                                <div class="price fl">预约金额：<i>500</i></div>
                            </div>
                            <div class="item-del fr">
                                <p>删除</p>
                            </div>
                        </div>
                    </div>
                    <div class="pay clearfix">
                        <div class="price fl">
                            预约金额：<i>500</i>
                        </div>
                        <div class="quantity clearfix fr">
                            <p class="btn-minus">
                                <a href="javascript:;">
                                    <img src="image/bcar/jian.png" alt="">
                                </a>
                            </p>
                            <p class="btn-input">
                                <input type="number" min="1" value="1">
                            </p>
                            <p class="btn-plus">
                                 <a href="javascript:;">
                                    <img src="image/bcar/jia.png" alt="">
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <div class="f-fx">
                <div class="clearfix">
                    <!-- 全选按钮 -->
                    <div class="ft-cb fl">
                        <p>
                            <input type="checkbox" id="cb-footer">
                            <label for="cb-footer"></label>
                        </p>
                    </div>
                    <div class="qx fl">全选</div>
                    <div class="pay fl">
                        <p>预约总金额：<i>0.0</i></p>
                    </div>
                    <div class="btn fr">
                        <p>结算</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
<script src="js/jquery-1.7.2.js"></script>
<script>
    $(function(){
        $('.state').on('click',function(){
            if($(this).find('p').html()=='编辑'){
                $(this).parents('.bundlev').find('.item-info').hide();
                $(this).parents('.bundlev').find('.pay').hide();
                $(this).parents('.bundlev').find('.delete').show();
                $(this).find('span').hide();
                $(this).find('p').html('完成').css('color','#D7B359');
                $(this).parents('.bundlev').find('.item-cb label').hide();
                $(this).parents('.bundlev').find('.title-shop .t-cb+label').hide();
                $("input").removeAttr('checked');
                success();
            }else{
                $(this).parents('.bundlev').find('.item-info').show();
                $(this).find('p').html('编辑').css('color','#4A4A4A');
                $(this).parents('.bundlev').find('.pay').show();
                $(this).parents('.bundlev').find('.delete').hide();
                $(this).find('span').show();
                $(this).parents('.bundlev').find('.item-cb label').show();
                $(this).parents('.bundlev').find('.title-shop .t-cb+label').show();
                success();
            }
        });
        function success(){
            if($('.state p').html()=='编辑'){
                $('.footer').show();
            }else{
                $('.footer').hide();
            }
        }
        success();
        //商铺全选
        $(".bundlev .shopcb label").click(function () {
            if($(this).prev().attr("checked")){
                $(this).parents(".bundlev").find(".group input[name=newslist]").each(function () {
                    $(this).attr("checked", false);
                } )
                GetCount();
            }else{
                $(this).parents(".bundlev").find(".group input[name=newslist]").each(function () {
                    $(this).attr("checked", true);
                });
                GetCount();
            }
        })
        //全选
        $('.ft-cb label').click(function(){
            if($(this).prev().attr("checked")){
                $(this).parents(".wrap").find("input[name=newslist]").each(function () {
                    $(this).attr("checked", false);
                } )
                GetCount();
            }
        })
        

        //数字加减
        $(".btn-plus").click(function () {
            $(this).prev().children().val(parseInt($(this).prev().children().val()) + 1)
            GetCount(); 
        })
        $(".btn-minus").click(function () {
            if($(this).next().children().val()>0){
                $(this).next().children().val(parseInt($(this).next().children().val()) - 1)
                GetCount(); 
            }
        })
        // function setTotal(who) {
        //     who.parent().prev().find("i").html((parseInt(who.parents('.pay').find('input').val()) * who.parents(".group").find(".item-info a .money1 i").html()));

        //     who.parents('.delete').find(".price i").html((parseInt(who.parents('.del').find('input').val()) * who.parents(".group").find(".item-info a .money1 i").html()));
            
        // }
        
        $('.item-cb label').click(function(){
            $(this).parents('.bundlev').children('.group').length;
        })
        // 全选
        //单选
        // var cout=0;
        // var couts=$(".group input[name=newslist]").length;
        // $(".group input[name=newslist]").click(function () {
        //      console.log(couts)

        //     cout++;

        //     if(cout==couts){
        //         console.log(cout)
        //         $('.ft-cb label').prev().attr('checked');
        //     }
        //     GetCount();
            
        // });
        var abc=0;

         $(".bundlev input[name=newslist]").click(function () {
            abc++;
            console.log(abc);
            console.log($(this).parents('.bundlev').find('.group').length);
            if(abc==$(this).parents('bundlev').find('.group').length){

            }
            $('.bundlev').each(function(){
                // console.log($(this).find('.group').length)
                
            })
            GetCount();
         })
        function GetCount() {
            //单个预约金额
            var Gin=$('.group .pay input');
            Gin.each(function(){
                $(this).parents('.quantity').prev().find('i').html(parseInt($(this).val()*200))
            });
            //编辑后的预约金额
            var Din=$('.group .del input');
            Din.each(function(){
                $(this).parents('.quantity').next().find('i').html(parseInt($(this).val()*200))
            });
            //获取总预约金额
            var conts = 0;
            $(".group input[name=newslist]").each(function () {
                if ($(this).attr("checked")) {
                    for (var i = 0; i < $(this).length; i++) {
                        conts += parseInt($(this).parents('.group').find('.pay .price i').html());
                    }
                }
            });
           $('.footer .pay i').html(conts);

        }
        GetCount();

        //删除
        $('.item-del p').on('click',function(){
            // console.log($(this).parents('.bundlev').find('.group').length)
            if($(this).parents('.bundlev').find('.group').length==1){
                $(this).parents('.bundlev').hide();

            }else if($(this).parents('.bundlev').find('.group').length>1){
                // console.log($(this).parent('.group'))
                $(this).parents('.group').hide();
            }
                $('.footer').show();
        })


        // function AllClick(){
        //     console.log($('.bundlev input[name=newslist]'))
        // }
        // AllClick();
    })
</script>
</html>